<script>
  async function lookupReference() {
    const refInput = document.getElementById('reference').value.trim();
    if (!refInput) {
      alert('Please enter a reference number.');
      return;
    }

    document.getElementById('result').innerText = 'Fetching info...';

    try {
      // âœ… This calls your secure serverless function instead of OpenAI directly
      const response = await fetch('/.netlify/functions/chatgpt-proxy', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ reference: refInput })
      });

      const data = await response.json();
      document.getElementById('result').innerText = data.reply;
    } catch (error) {
      console.error(error);
      document.getElementById('result').innerText = 'Error fetching data.';
    }
  }
</script>
